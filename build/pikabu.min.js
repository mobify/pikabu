/*! mobify-pikabu 0.2.2 2014-04-10 */
var Mobify=window.Mobify=window.Mobify||{};Mobify.$=Mobify.$||window.Zepto||window.jQuery,function(t){function e(){function t(){var t=["webkit","moz","o","ms"],e=document.createElement("div"),i=document.getElementsByTagName("body")[0],s=!1;i.appendChild(e);for(var n=0;t.length>n;n++){var o=t[n];e.style[o+"OverflowScrolling"]="touch"}e.style.overflowScrolling="touch";var r=window.getComputedStyle&&window.getComputedStyle(e);r||(r=e.currentStyle),s=!!r.overflowScrolling;for(var n=0;t.length>n;n++){var o=t[n];if(r[o+"OverflowScrolling"]){s=!0;break}}return e.parentNode.removeChild(e),s}function e(){var t=/Android\s+([\d\.]+)/.exec(window.navigator.userAgent);return!(!t||!t.length)}function i(){var t=/Android\s+([\d\.]+)/.exec(window.navigator.userAgent);return!!(t&&t.length&&3>parseInt(t[1]))}function s(){var t=document.body||document.documentElement,e=t.style,i="transition";if("string"==typeof e[i])return!0;v=["Moz","Webkit","Khtml","O","ms"],i=i.charAt(0).toUpperCase()+i.substr(1);for(var s=0;v.length>s;s++)if("string"==typeof e[v[s]+i])return!0;return!1}function n(){var t,e=document.createElement("p"),i={webkitTransform:"-webkit-transform",OTransform:"-o-transform",msTransform:"-ms-transform",MozTransform:"-moz-transform",transform:"transform"};document.body.insertBefore(e,null);for(var s in i)void 0!==e.style[s]&&(e.style[s]="translate3d(1px,1px,1px)",t=window.getComputedStyle(e).getPropertyValue(i[s]));return document.body.removeChild(e),void 0!==t&&t.length>0&&"none"!==t}function o(){if(/iPhone\ OS\ 3_1/.test(navigator.userAgent))return void 0;var t,e=document.createElement("fakeelement"),i={transition:"transitionEnd transitionend",OTransition:"oTransitionEnd",MSTransition:"msTransitionEnd",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"};for(t in i)if(void 0!==e.style[t])return i[t]}function r(t){var e=navigator.userAgent.match(/Chrome\/([\d\.]+)\s/),t=29;return e&&parseFloat(e[1])>=t}return{hasOverflowScrollingTouch:t(),isAndroid:e(),isLegacyAndroid:i(),supportsTransitions:s(),has3d:n(),transitionEvent:o(),isNewChrome:r(),height:window.innerHeight+81,width:window.innerWidth}}window.Pikabu=function(e){var i=t.extend(this,{$document:t("html"),leftVisibleClass:"m-pikabu-left-visible",rightVisibleClass:"m-pikabu-right-visible",activePikabuStylesSelector:"#m-pikabu-styles",settings:{viewportSelector:".m-pikabu-viewport",selectors:{element:".m-pikabu-container",common:".m-pikabu-sidebar",left:".m-pikabu-left",right:".m-pikabu-right",overlay:".m-pikabu-overlay",navToggles:".m-pikabu-nav-toggle"},widths:{left:"80%",right:"80%"},transitionSpeed:.2,onInit:function(){},onOpened:function(){},onClosed:function(){}}});return i.init(e),i},Pikabu.prototype.scrollTo=function(t,e,i){var s=function(t,e,i){return t+(e-t)*i},n=function(t){return-Math.cos(t*Math.PI)/2+.5},t=t||(this.device.isAndroid?1:0),e=e||200;"function"==typeof i&&(n=i),Date.now=Date.now||function(){return+new Date};var o=window.pageYOffset,r=Date.now(),a=r+e,l=function(){var i=+new Date,h=i>a?1:(i-r)/e;window.scrollTo(0,s(o,t,n(h))),i>a||setTimeout(l,15)};l()},Pikabu.prototype.init=function(i){var s=this.settings;t("html").removeClass("no-js"),this.device=Pikabu.prototype.device||e(),this.markDeviceCharacteristics(),t.extend(!0,s,i),this.$viewport=t(this.settings.viewportSelector),this.$element=t(s.selectors.element),this.$sidebars={left:t(s.selectors.left),right:t(s.selectors.right)},this.$navToggles=t(s.selectors.navToggles),t(s.selectors.overlay).length||this.$element.prepend('<div class="'+s.selectors.overlay.slice(1)+'">'),this.$overlay=t(s.selectors.overlay),this.applyPersistentStyles(),this.bindHandlers(),this.bindEvents(),this.$sidebars.left.addClass("m-pikabu-hidden"),this.$sidebars.right.addClass("m-pikabu-hidden"),this.settings=s,this.setViewportWidth(),this.$element.trigger("pikabu:initialized")},Pikabu.prototype.bindEvents=function(){this.$element.on("pikabu:initialized",this.settings.onInit),this.$element.on("pikabu:opened",this.settings.onOpened),this.$element.on("pikabu:closed",this.settings.onClosed)},Pikabu.prototype.bindHandlers=function(){var e=this;this.$navToggles.on("click",function(i){i.stopPropagation(),e.openSidebar(t(this).attr("data-role"))}),this.$overlay.on("click",function(t){t.stopPropagation(),e.closeSidebars()}),t(window).on("resize orientationchange",function(){var i=t(window).height();e.activeSidebar?(e.setHeights(),e.setViewportWidth()):(e.$sidebars.left.is(":visible")||e.$sidebars.right.is(":visible"))&&(e.$viewport.height(i),e.$sidebars.left.height(i),e.$sidebars.right.height(i))})},Pikabu.prototype.markDeviceCharacteristics=function(){this.device.hasOverflowScrollingTouch&&this.$document.addClass("m-pikabu-overflow-scrolling"),this.device.isLegacyAndroid&&this.$document.addClass("m-pikabu-legacy-android"),this.device.supportsTransitions&&this.$document.addClass("m-pikabu-transitions"),this.device.has3d&&this.$document.addClass("m-pikabu-translate3d")},Pikabu.prototype.applyPersistentStyles=function(){var t=this.settings.selectors.common+", \n"+this.settings.selectors.element,e="."+this.leftVisibleClass+" "+this.settings.selectors.left,i="."+this.rightVisibleClass+" "+this.settings.selectors.right,s="<style>\n"+t+" {\n"+"-webkit-transition: -webkit-transform "+this.settings.transitionSpeed+"s ease-in;\n"+"-moz-transition: -moz-transform "+this.settings.transitionSpeed+"s ease-in;\n"+"-ms-transition: -ms-transform "+this.settings.transitionSpeed+"s ease-in;\n"+"-o-transition: -o-transform "+this.settings.transitionSpeed+"s ease-in;\n"+"transition: transform "+this.settings.transitionSpeed+"s ease-in;\n"+"}\n"+e+" {\n"+"	width: "+this.settings.widths.left+";\n"+"}\n"+i+" {\n"+"	width: "+this.settings.widths.right+";\n"+"}"+"</style>";this.$document.find("head").append(s)},Pikabu.prototype.applyTransformations=function(t){var e,i;e=this.settings.widths[t],i="left"===t?e:"-"+e;var s='<style id="'+this.activePikabuStylesSelector.slice(1)+'">\n'+this.settings.selectors.element+" {\n"+"	-webkit-transform: translate3d("+i+", 0, 0);\n"+"	-moz-transform: translate3d("+i+", 0, 0);\n"+"	-ms-transform: translate3d("+i+", 0, 0);\n"+"	-o-transform: translate3d("+i+", 0, 0);\n"+"	transform: translate3d("+i+", 0, 0);\n"+"}\n"+this.settings.selectors[t]+" {\n"+"	-webkit-transform: translate3d(0, 0, 0);\n"+"	-moz-transform: translate3d(0, 0, 0);\n"+"	-ms-transform: translate3d(0, 0, 0);\n"+"	-o-transform: translate3d(0, 0, 0);\n"+"	transform: translate3d(0, 0, 0);\n"+"}"+"</style>";this.$document.find("head").append(s)},Pikabu.prototype.openSidebar=function(t){this.scrollOffset=window.pageYOffset,this.$sidebars[t].removeClass("m-pikabu-hidden"),this.activeSidebar=t,this.$sidebars[t].addClass("m-pikabu-overflow-touch"),this.$document.addClass("m-pikabu-"+t+"-visible"),this.setHeights(),this.setViewportWidth(),this.applyTransformations(t),this.scrollTo(0),this.$element.trigger("pikabu:opened")},Pikabu.prototype.resetSidebar=function(t){t.removeClass("m-pikabu-overflow-touch"),this.$viewport.css("height",""),this.$element.css("height",""),this.$element.css("marginBottom",1),this.scrollTo(0),this.$element.css("marginBottom",""),this.$sidebars.left.addClass("m-pikabu-hidden"),this.$sidebars.right.addClass("m-pikabu-hidden"),this.activeSidebar=null,this.$element.trigger("pikabu:closed")},Pikabu.prototype.closeSidebars=function(){var e=this;this.$document.removeClass(this.leftVisibleClass+" "+this.rightVisibleClass),this.$viewport.css("width","auto"),t(this.activePikabuStylesSelector).remove(),this.device.transitionEvent&&this.activeSidebar?this.$element.one(this.device.transitionEvent,function(){e.resetSidebar(t(this)),e.scrollTo(e.scrollOffset)}):setTimeout(function(){e.resetSidebar(t(this)),e.scrollTo(e.scrollOffset)},250)},Pikabu.prototype.setViewportWidth=function(){var t="auto";this.device.isLegacyAndroid&&0==orientation&&(t=Math.max(this.device.height,this.device.width)),this.$viewport.css("width",t)},Pikabu.prototype.setHeights=function(){var e=this.device.isNewChrome?window.outerHeight:t(window).height(),i=this.activeSidebar&&this.$sidebars[this.activeSidebar],s=i.removeAttr("style")[0].scrollHeight,n=Math.max(e,s);this.device.hasOverflowScrollingTouch?(i.height(e),this.$element.height(e),this.$viewport.height(e),this.$overlay.height(e)):(i.height(n),this.$viewport.height(n),this.$overlay.height(n),this.$element.height(n))}}(Mobify.$);